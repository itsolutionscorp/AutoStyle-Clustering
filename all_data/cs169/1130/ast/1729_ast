s(:block, s(:defn, :combine_anagrams, s(:args, :words), s(:lasgn, :anagram_groups, s(:array)), s(:lasgn, :checked, s(:array)), s(:iter, s(:call, s(:lvar, :words), :each), s(:args, :word), s(:block, s(:lasgn, :canonical, s(:call, nil, :canonical_repr, s(:lvar, :word))), s(:if, s(:call, s(:call, s(:lvar, :checked), :include?, s(:lvar, :canonical)), :!), s(:block, s(:call, s(:lvar, :anagram_groups), :<<, s(:call, nil, :find_anagrams, s(:lvar, :canonical), s(:lvar, :words))), s(:call, s(:lvar, :checked), :<<, s(:lvar, :canonical))), nil))), s(:lvar, :anagram_groups)), s(:defn, :find_anagrams, s(:args, :canonical, :words), s(:lasgn, :found, s(:array)), s(:iter, s(:call, s(:lvar, :words), :each), s(:args, :word), s(:if, s(:call, s(:lvar, :canonical), :==, s(:call, nil, :canonical_repr, s(:lvar, :word))), s(:call, s(:lvar, :found), :<<, s(:lvar, :word)), nil)), s(:lvar, :found)), s(:defn, :canonical_repr, s(:args, :word), s(:call, s(:call, s(:call, s(:call, s(:lvar, :word), :downcase), :gsub, s(:lit, /[^\w]/), s(:str, "")), :split, s(:str, "")), :sort)))